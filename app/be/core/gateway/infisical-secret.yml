apiVersion: secrets.infisical.com/v1alpha1
kind: InfisicalSecret
metadata:
  name: infisical-secret-gateway
  namespace: app
  labels:
    app: gateway
spec:
  hostAPI: http://10.1.1.12:80
  resyncInterval: 10
  authentication:
    kubernetesAuth:
      identityId: "043936b5-a805-459f-b8f1-006941183312"
      autoCreateServiceAccountToken: true
      serviceAccountRef:
        name: infisical-service-account
        namespace: security
      secretsScope:
        projectSlug: hsm-qq36
        envSlug: dev
        secretsPath: "/hsm-be-core-gateway"
        recursive: true

  managedKubeSecretReferences:
    - secretName: hsm-be-core-gateway-secret
      secretNamespace: app
      creationPolicy: "Orphan"
      template:
        includeAllSecrets: false
        data:
          ENVIRONMENT: "{{.ENVIRONMENT.Value}}"
          JWT_SECRET: "{{.JWT_SECRET.Value}}"